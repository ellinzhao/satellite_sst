device: "cuda"
seed: 3

sst_dir: "/tmp/sst"
cloud_dir: "/tmp/cloud"
fnd_sst_path: "/content/mur25_2012_foundation.nc"
save_dir: "/content/drive/MyDrive/sst/runs"

epochs: 40
save_epoch: 5
val_epoch: 2

wandb:
  entity: ellinzh
  project: sat_sst
  name: colab_ssta

var: ssta
use_triplet: false
use_loc: false

# Model must be the ResNet backbone autoencoder
model:
  n_enc_layers: 4
  dec_data_chs: [896, 512, 128, 64]
  dec_mask_chs: [128, 96, 64, 32]

optim:
  name: Adam
  lr: 0.01

scheduler:
  name: CosineAnnealingWarmRestarts
  args:
    - 10
  kwargs:
    T_mult: 3
    eta_min: 0.0001

train:
  name: SSTDataset
  kwargs:
    K: 1
    preload: false
    return_coord: ${use_loc}
    fnd_sst_path: ${fnd_sst_path}
    cloud_ratio_range: [0.4, 0.8]
  loader:
    batch_size: 64
    pin_memory: false
    num_workers: 2
    prefetch_factor: 6
    shuffle: true

# Val dataset is always SSTDataset regardless of the train dataset
val:
  name: SSTDataset
  kwargs:
    K: 1
    preload: false
    return_coord: ${use_loc}
    fnd_sst_path: ${fnd_sst_path}
    cloud_ratio_range: ${train.kwargs.cloud_ratio_range}
  loader:
    batch_size: 64
    pin_memory: false
    num_workers: 2
    prefetch_factor: 6
    shuffle: false

loss:
  sst_loss:
    name: MaskedLoss
    weight: 1
  ssim_loss:
    name: GradientSSIMLoss
    weight: 1
  mask_loss:
    name: MaskBCELoss
    weight: 0.1

val_loss:
  sst_loss:
    name: MaskedLoss
  ssim_loss:
    name: SSIMLoss
